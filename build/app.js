!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){return Math.floor(Math.random()*(e-t+1)+t)}n.r(e);class o{constructor(t){this.startTime=null,this.container=null,this.timerIntervalVar=null,this.maxSeconds=999,this.container=t}start(){var t,e;this.startTime=new Date,this.container.innerText=0,this.timerIntervalVar=setInterval((t=this,e=this.reTime,function(){e.apply(t,arguments)}))}reTime(){let t=new Date,e=Math.abs(t.getTime()-this.startTime.getTime()),n=Math.floor(e/1e3);if(n<this.maxSeconds){let t=(""+n).length;for(let e=0;e<3-t;e++)n="0"+n;this.container.innerHTML="Timer: "+n}else this.container.innerHTML="You are taking too long, I quit! <br/><br/> Kind regards,<br/> timer.",this.stop()}stop(){clearInterval(this.timerIntervalVar)}}const r=0,s=1,l=2;function h(t){switch(t){case"up":return"down";case"down":return"up";case"left":return"right";case"right":return"left"}}function c(t){let e=[];return t.forEach(function(t){const n=t.filter(function(t){return t.color===r&&function(t){return!!t.neighbours.find(function(t){return t.neighbour.color===l&&a(t.neighbour)<3})}(t)});e=e.concat(n)}),e?e[i(0,e.length-1)]:null}function a(t){return(!!t.up&&1)+(!!t.right&&1)+(!!t.down&&1)+(!!t.left&&1)}const u=[["up"],["up","right"],["up","down"],["up","down","right"],["up","down","left","right"],[]];class f{constructor(t,e){this.rows=t,this.columns=e,this.map=[],this.startCell={i:0,j:0},this.direction={any:0,left:1,right:2,up:3,down:4}}initMap(t){this.map=[];for(let e=0;e<this.rows;e++){this.map[e]=[];for(let n=0;n<this.columns;n++)this.map[e][n]=t?this.createRandomCell():this.createEmptyCell()}}createEmptyCell(t){return{up:!1,down:!1,left:!1,right:!1,connected:!!t,locked:!1}}createRandomCell(t){return{up:!!i(0,1),down:!!i(0,1),left:!!i(0,1),right:!!i(0,1),connected:!!t,locked:!1}}rotateCellCCW(t,e){let n=this.map[t][e],i=n.left;n.left=n.up,n.up=n.right,n.right=n.down,n.down=i}rotateCellCW(t,e){let n=this.map[t][e],i=n.left;n.left=n.down,n.down=n.right,n.right=n.up,n.up=i}resetConnections(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.map[t][e].connected=!1;this.connect(this.startCell.i,this.startCell.j,this.direction.any)}connect(t,e,n){let i=this.map[t][e];i&&!i.connected&&this.resolveDirection(t,e,n)&&(i.connected=!0,i.left&&t>0&&this.connect(t-1,e,this.direction.right),i.right&&t<this.columns-1&&this.connect(t+1,e,this.direction.left),i.up&&e>0&&this.connect(t,e-1,this.direction.down),i.down&&e<this.rows-1&&this.connect(t,e+1,this.direction.up))}resolveDirection(t,e,n){return n==this.direction.any||(!(n!=this.direction.left||!this.map[t][e].left)||(!(n!=this.direction.right||!this.map[t][e].right)||(!(n!=this.direction.up||!this.map[t][e].up)||!(n!=this.direction.down||!this.map[t][e].down))))}restart(){let t=i(0,this.columns-1),e=i(0,this.rows-1);this.startCell={i:t,j:e},this.initMap(),this.generateMap(function(t,e){const n=function(t,e){const n=[];for(let i=0;i<t;i++){n[i]=[];for(let t=0;t<e;t++){n[i][t]={color:r,neighbours:[],x:i,y:t};const e=n[i][t];if(t>0){const o=n[i][t-1];e.neighbours.push({direction:"up",neighbour:o}),o.neighbours.push({direction:"down",neighbour:e})}if(i>0){const o=n[i-1][t];e.neighbours.push({direction:"left",neighbour:o}),o.neighbours.push({direction:"right",neighbour:e})}}}return n}(t,e),o=[],u=n[i(0,t-1)][i(0,e-1)];for(u.color=s,o.push(u);o.length;){const t=o.shift();t.color=l;const e=t.neighbours.filter(function(t){return t.neighbour.color===r}),u=i(0,Math.min(a(t)?2:3,e.length));for(let n=0;n<u;n++){const n=i(0,e.length-1),{direction:r,neighbour:l}=e[n];e.splice(n,1),t[r]=l,l[h(r)]=t,l.color=s,o.push(l)}if(0==o.length){const t=c(n);if(t){const e=t.neighbours.filter(function(t){return t.neighbour.color===l&&a(t.neighbour)<3});if(e.length){const{direction:n,neighbour:r}=e[i(0,e.length-1)];t[n]=r,r[h(n)]=t,o.push(t)}}}}return function(t){const e=[];for(let n of t){const t=[];for(let e in n){let i=0;n[e].up&&i++,n[e].down&&i++,n[e].left&&i++,n[e].right&&i++;let o=i;0===i&&(o=5),1===i&&(o=0),2===i&&(!!n[e].up&&1)+(!!n[e].right&&2)+(!!n[e].down&&1)+(!!n[e].left&&2)===3&&(o=1),t.push(o)}e.push(t)}return e}(n)}(this.rows,this.columns)),this.resetConnections()}generateMap(t){for(let e=0;e<this.columns;e++)for(let n=0;n<this.rows;n++){let o=u[t[e][n]];for(let t=0;t<o.length;t++)this.map[n][e][o[t]]=!0;let r=i(0,3);for(;r--;)this.rotateCellCCW(n,e)}}checkSolution(){for(let t=0;t<this.columns;t++)for(let e=0;e<this.rows;e++)if(!this.map[t][e].connected)return!1;return!0}toggleLock(t,e){this.map[t][e].locked=!this.map[t][e].locked}}class p{constructor(t,e,n){this.gl=t.getContext("2d"),this.engine=new f(e,n),this.canvas=t,this.stepX=(this.canvas.width-1)/this.engine.columns,this.stepY=(this.canvas.height-1)/this.engine.rows}draw(){const t=this.gl;t.globalAlpha=1,t.fillStyle="Black",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.strokeStyle="Gray",t.lineWidth=1,t.beginPath();let e=0,n=0;for(let n=0;n<=this.engine.columns;n++)e=Math.floor(n*this.stepX)+.5,t.moveTo(e,0),t.lineTo(e,this.canvas.height);for(let e=0;e<=this.engine.rows;e++)n=Math.floor(e*this.stepY)+.5,t.moveTo(0,n),t.lineTo(this.canvas.width,n);t.stroke(),t.lineWidth=3;for(let i=0;i<this.engine.columns;i++)for(let o=0;o<this.engine.rows;o++){e=Math.floor(i*this.stepX+this.stepX/2)+.5,n=Math.floor(o*this.stepY+this.stepY/2)+.5;let r=this.engine.map[i][o];if(r.locked&&(t.fillStyle="#0A2A0A",t.fillRect(e-this.stepX/2,n-this.stepY/2,this.stepX,this.stepY)),this.engine.startCell.i==i&&this.engine.startCell.j==o){let i=t.createRadialGradient(e,n,1,e,n,Math.min(this.stepX/2,this.stepY/2));i.addColorStop(0,"green"),i.addColorStop(1,"transparent"),t.fillStyle=i,t.fillRect(e-this.stepX/2,n-this.stepY/2,this.stepX,this.stepY)}t.beginPath(),r.left&&(t.moveTo(e,n),t.lineTo(e-this.stepX/2,n)),r.right&&(t.moveTo(e,n),t.lineTo(e+this.stepX/2,n)),r.up&&(t.moveTo(e,n),t.lineTo(e,n-this.stepY/2)),r.down&&(t.moveTo(e,n),t.lineTo(e,n+this.stepY/2)),r.connected?t.strokeStyle="Chartreuse ":t.strokeStyle="White",t.stroke()}}drawWin(){let t=this.gl;t.globalAlpha=.8,t.fillStyle="Black",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.textAlign="center",t.font="30pt Calibri",t.fillStyle="Chartreuse",t.fillText("You won!",this.canvas.width/2,this.canvas.height/2)}start(){this.engine.restart(),this.draw()}click(t,e,n,i){let o=this.canvas.getBoundingClientRect(),r=Math.floor((e-o.left)/this.stepX),s=Math.floor((n-o.top)/this.stepX);this.engine.map[r][s].locked||(0===t?this.engine.rotateCellCCW(r,s):2===t&&this.engine.rotateCellCW(r,s)),1===t&&this.engine.toggleLock(r,s),this.engine.resetConnections(),this.draw(),this.engine.checkSolution()&&(this.drawWin(),timer.stop(),i.call())}}let d=null,g=null;function m(t){t.preventDefault(),d.click(t.button,t.clientX,t.clientY,v)}function w(t){t.preventDefault(),d.click(0,t.touches[0].pageX,t.touches[0].pageY,v)}function v(){d.canvas.removeEventListener("mousedown",m,!1),d.canvas.removeEventListener("touchstart",w,!1)}window.onload=function(){!function(){const t=document.getElementById("game");(d=new p(t,10,10)).start(),t.addEventListener("contextmenu",function(t){t.preventDefault()},!1),d.canvas.addEventListener("mousedown",m,!1),d.canvas.addEventListener("touchstart",w,!1)}(),function(){const t=document.getElementById("timer");(g=new o(t)).start()}()}}]);